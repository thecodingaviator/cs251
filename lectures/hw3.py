import numpy as np

B = [[1, 0, 0, 3],
     [0, 1, 0, 4],
     [0, 0, 1, 5],
     [0, 0, 0, 1]]

B = np.array(B)

C = [[0.2,   0,    0, 0],
     [0,   0.5,   0,  0],
     [0,      0, 0.1, 0],
     [0,      0,    0, 1]]

C = np.array(C)

D = [[0.67203, 0.30185, 0.72389],
     [0.68096, 0.96934, 0.52625],
     [0.45966, 0.12947, 0.39766],
     [0.16762, 0.51201, 0.37415],
     [0.91317, 0.00627, 0.02902],
     [0.74685, 0.27523, 0.71118],
     [0.63216, 0.47761, 0.27835],
     [0.14732, 0.61891, 0.77322],
     [0.75892, 0.35676, 0.76397],
     [0.80039, 0.41627, 0.46323]]

D = np.array(D)

# Create Dh with a column of 1s
Dh = np.hstack((D, np.ones((D.shape[0], 1))))

T = B @ C @ Dh.T

print(Dh.shape)
